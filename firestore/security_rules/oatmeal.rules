

// starting rules
service cloud.firestore {
    match /databases/{database}/documents {

        function isSignedIn () {
            return request.auth != null;
        }
        function canGiveTalk (rsc) {
            return rsc.data.canGiveTalk;
        }

        allow read, write: if isSignedIn();

        match /talks/{talkId} {
            // only those "who can give talks" can create talks
            allow create: if canGiveTalk(get(/databases/$(database)/documents/persons/$(request.auth.uid)));
        }

    }
}
